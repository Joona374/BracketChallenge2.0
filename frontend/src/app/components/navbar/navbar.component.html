<nav class="navbar" [class.mobile]="isMobileView">
  <div class="navbar-left">
    <a routerLink="/" class="brand">
      <img
        src="https://res.cloudinary.com/dqwx4hrsc/image/upload/v1744022575/logo_cyjav5.png"
        alt="Logo"
        class="brand-logo"
      />NHL Bracket Challenge 2025</a
    >
  </div>

  <div class="navbar-center">
    <button
      class="hamburger"
      *ngIf="isMobileView"
      (click)="toggleMenu()"
      aria-label="Toggle navigation"
    >
      ‚ò∞
    </button>
  </div>

  <div class="navbar-timer" *ngIf="timeLeft !== ''">
    <div class="ominous-timer" [class.locked]="timeLeft === 'LOCKED'">
      <span *ngIf="timeLeft !== 'LOCKED'">‚è≥ {{ timeLeft }}</span>
      <span *ngIf="timeLeft === 'LOCKED'">üíÄ AIKA ONA P√Ñ√ÑTTYNYT üíÄ</span>
    </div>
  </div>

  <div class="navbar-right" [class.open]="menuOpen || !isMobileView">
    <ng-container *ngIf="isLoggedIn; else guestLinks">
      <!-- Dropdown menu for gameplay options -->
      <div class="dropdown" (clickOutside)="isDropdownOpen = false">
        <button class="dropdown-toggle" (click)="toggleDropdown()">
          Veikkaukset <i class="fas fa-caret-down"></i>
        </button>
        <div class="dropdown-menu" [class.show]="isDropdownOpen">
          <a routerLink="/bracket" routerLinkActive="active-link">Bracket</a>
          <a routerLink="/lineup" routerLinkActive="active-link">Kokoonpano</a>
          <a routerLink="/predictions" routerLinkActive="active-link"
            >Top 3 Pelaajat</a
          >
        </div>
      </div>

      <a routerLink="/leaderboard" routerLinkActive="active-link"
        >Sarjataulukko</a
      >
      <a routerLink="/rules" routerLinkActive="active-link">S√§√§nn√∂t & Ohjeet</a>
      <a routerLink="/vote" routerLinkActive="active-link">√Ñ√§nestys</a>

      <!-- Admin link - only shown for admin users -->
      <a
        *ngIf="user?.isAdmin"
        routerLink="/admin"
        routerLinkActive="active-link"
        class="admin-link"
      >
        Hallintapaneeli
      </a>

      <a
        routerLink="/dashboard"
        routerLinkActive="active-link"
        class="avatar-nav-link"
      >
        <div class="avatar-circle-nav">
          <!-- Use ngIf with proper null check and error handling for the logo -->
          <img
            *ngIf="user && user.logoUrl"
            [src]="user.logoUrl"
            class="team-logo-nav"
            alt="Team Logo"
            (error)="user.logoUrl = null"
          />
          <span *ngIf="!user?.logoUrl" class="initials">{{
            getUserInitials()
          }}</span>
        </div>
      </a>
      <button (click)="logout()">Kirjaudu Ulos</button>
    </ng-container>

    <ng-template #guestLinks>
      <a routerLink="/rules" routerLinkActive="active-link">S√§√§n√∂t & Ohjeet</a>
      <a routerLink="/vote" routerLinkActive="active-link">√Ñ√§nestys</a>
      <a routerLink="/login" routerLinkActive="active-link">Kirjautuminen</a>
      <a routerLink="/register" routerLinkActive="active-link">Rekister√∂idy</a>
    </ng-template>
  </div>
</nav>
