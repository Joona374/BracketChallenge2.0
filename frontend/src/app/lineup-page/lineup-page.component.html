<!-- New container for top section -->
<div class="lineup-top-container">
  <!-- Left side: player slots -->
  <div class="lineup-wrapper">
    <h2 class="section-header">Select Your Starting Lineup</h2>

    <div class="slot-container">
      <!-- Forwards -->
      <div class="lineup-row forwards">
        <div
          *ngFor="let slot of forwardSlots"
          class="slot"
          [ngClass]="getPlayerClass(slot)"
          [class.active]="selectedSlot === slot"
          (click)="selectedSlot = slot"
        >
          <span>{{ formatPlayer(slot) }}</span>
        </div>
      </div>

      <!-- Defenders -->
      <div class="lineup-row defenders">
        <div class="spacer"></div>
        <div
          *ngFor="let slot of defenderSlots"
          class="slot"
          [ngClass]="getPlayerClass(slot)"
          [class.active]="selectedSlot === slot"
          (click)="selectedSlot = slot"
        >
          <span>{{ formatPlayer(slot) }}</span>
        </div>
      </div>

      <!-- Goalie -->
      <div class="lineup-row goalie">
        <div class="spacer"></div>
        <div class="spacer"></div>
        <div
          class="slot"
          [ngClass]="getPlayerClass(goalieSlot)"
          [class.active]="selectedSlot === goalieSlot"
          (click)="selectedSlot = goalieSlot"
        >
          <span>{{ formatPlayer(goalieSlot) }}</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Right side: budget and controls -->
  <div class="lineup-side-panel">
    <!-- Budget display -->
    <div class="budget-display">
      <span class="budget-label">Remaining Budget:</span>
      <span
        class="budget-value"
        [ngClass]="{ 'budget-warning': remainingBudget < 100000 }"
      >
        {{ formatPrice(remainingBudget) }}
      </span>
    </div>

    <!-- Controls (fixed typo in class name) -->
    <div class="controls">
      <button class="lineup-button save" (click)="saveLineup()">
        üíæ Save Lineup
      </button>
      <button class="lineup-button clear" (click)="clearLineup()">
        üßπ Clear Lineup
      </button>
      <input
        type="text"
        placeholder="Search by name or team..."
        [(ngModel)]="searchTerm"
        class="search-box"
      />
    </div>
  </div>
</div>

<!-- Scrollable Player Table -->
<div class="player-table-container">
  <!-- Table content remains unchanged -->
</div>

<!-- Scrollable Player Table -->
<div class="player-table-container">
  <table class="player-table">
    <thead>
      <tr>
        <th
          (click)="sortBy('position')"
          [class.sorted]="sortKey === 'position'"
        >
          Position
          <span *ngIf="sortKey === 'position'">{{ sortAsc ? "‚ñ≤" : "‚ñº" }}</span>
        </th>
        <th
          (click)="sortBy('firstName')"
          [class.sorted]="sortKey === 'firstName'"
        >
          First
          <span *ngIf="sortKey === 'firstName'">{{ sortAsc ? "‚ñ≤" : "‚ñº" }}</span>
        </th>
        <th
          (click)="sortBy('lastName')"
          [class.sorted]="sortKey === 'lastName'"
        >
          Last
          <span *ngIf="sortKey === 'lastName'">{{ sortAsc ? "‚ñ≤" : "‚ñº" }}</span>
        </th>
        <th (click)="sortBy('team')" [class.sorted]="sortKey === 'team'">
          Team <span *ngIf="sortKey === 'team'">{{ sortAsc ? "‚ñ≤" : "‚ñº" }}</span>
        </th>
        <th (click)="sortBy('isU23')" [class.sorted]="sortKey === 'isU23'">
          U23
          <span *ngIf="sortKey === 'isU23'">{{ sortAsc ? "‚ñ≤" : "‚ñº" }}</span>
        </th>
        <th
          (click)="sortBy('reg_gp')"
          [class.sorted]="sortKey === 'reg_gp'"
          class="stat-column"
        >
          GP
          <span *ngIf="sortKey === 'reg_gp'">{{ sortAsc ? "‚ñ≤" : "‚ñº" }}</span>
        </th>
        <th
          (click)="sortBy('reg_goals')"
          [class.sorted]="sortKey === 'reg_goals'"
          class="stat-column"
        >
          G
          <span *ngIf="sortKey === 'reg_goals'">{{ sortAsc ? "‚ñ≤" : "‚ñº" }}</span>
        </th>
        <th
          (click)="sortBy('reg_assists')"
          [class.sorted]="sortKey === 'reg_assists'"
          class="stat-column"
        >
          A
          <span *ngIf="sortKey === 'reg_assists'">{{
            sortAsc ? "‚ñ≤" : "‚ñº"
          }}</span>
        </th>
        <th
          (click)="sortBy('reg_points')"
          [class.sorted]="sortKey === 'reg_points'"
          class="stat-column"
        >
          P
          <span *ngIf="sortKey === 'reg_points'">{{
            sortAsc ? "‚ñ≤" : "‚ñº"
          }}</span>
        </th>
        <th
          (click)="sortBy('reg_plus_minus')"
          [class.sorted]="sortKey === 'reg_plus_minus'"
          class="stat-column"
        >
          +/-
          <span *ngIf="sortKey === 'reg_plus_minus'">{{
            sortAsc ? "‚ñ≤" : "‚ñº"
          }}</span>
        </th>
        <th (click)="sortBy('price')" [class.sorted]="sortKey === 'price'">
          Price
          <span *ngIf="sortKey === 'price'">{{ sortAsc ? "‚ñ≤" : "‚ñº" }}</span>
        </th>
      </tr>
    </thead>

    <tbody>
      <tr
        *ngFor="let player of availablePlayers"
        (click)="assignPlayerToSlot(player)"
      >
        <td>{{ player?.position || "" }}</td>
        <td>{{ player?.firstName || "" }}</td>
        <td>{{ player?.lastName || "" }}</td>
        <td>{{ player?.team || "" }}</td>
        <td>{{ player?.isU23 ? "‚úì" : "‚ùå" }}</td>
        <td class="stat-column">{{ player?.reg_gp || 0 }}</td>
        <td class="stat-column">{{ player?.reg_goals || 0 }}</td>
        <td class="stat-column">{{ player?.reg_assists || 0 }}</td>
        <td class="stat-column">{{ player?.reg_points || 0 }}</td>
        <td
          class="stat-column"
          [class.positive]="(player?.reg_plus_minus || 0) > 0"
          [class.negative]="(player?.reg_plus_minus || 0) < 0"
        >
          {{ (player?.reg_plus_minus || 0) > 0 ? "+" : ""
          }}{{ player?.reg_plus_minus || 0 }}
        </td>
        <td>{{ formatPrice(player?.price || 0) }}</td>
      </tr>
    </tbody>
  </table>
</div>
