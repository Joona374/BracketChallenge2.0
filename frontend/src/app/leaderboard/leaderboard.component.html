<div class="leaderboard-container">
  <h2 class="section-header">NHL Bracket Challenge Sarjataulukko</h2>

  <!-- Loading indicator -->
  <div class="loading-overlay" *ngIf="loading">
    <div class="loading-spinner"></div>
    <div class="loading-text">Loading leaderboard data...</div>
  </div>

  <!-- Error message -->
  <div class="error-message" *ngIf="error">{{ error }}</div>

  <!-- Top 3 Podium Display - Simplified Version -->
  <div
    class="podium-container"
    *ngIf="leaderboardEntries.length >= 3 && !loading"
  >
    <div class="podium-wrapper">
      <!-- Second Place -->
      <div class="podium-place second-place">
        <div class="podium-content">
          <div class="podium-medal">ü•à</div>
          <div class="podium-logo-container">
            <img
              *ngIf="getTopThree()[1].logoUrl"
              [src]="getTopThree()[1].logoUrl"
              [alt]="getTopThree()[1].teamName + ' logo'"
              class="podium-logo"
            />
          </div>
          <div class="podium-team">{{ getTopThree()[1].teamName }}</div>
          <div class="podium-points">{{ getTopThree()[1].totalPoints }}</div>
        </div>
        <div class="podium-block second"></div>
      </div>

      <!-- First Place -->
      <div class="podium-place first-place">
        <div class="podium-content">
          <div class="podium-medal">üèÜ</div>
          <div class="podium-logo-container">
            <img
              *ngIf="getTopThree()[0].logoUrl"
              [src]="getTopThree()[0].logoUrl"
              [alt]="getTopThree()[0].teamName + ' logo'"
              class="podium-logo"
            />
          </div>
          <div class="podium-team">{{ getTopThree()[0].teamName }}</div>
          <div class="podium-points">{{ getTopThree()[0].totalPoints }}</div>
        </div>
        <div class="podium-block first"></div>
      </div>

      <!-- Third Place -->
      <div class="podium-place third-place">
        <div class="podium-content">
          <div class="podium-medal">ü•â</div>
          <div class="podium-logo-container">
            <img
              *ngIf="getTopThree()[2].logoUrl"
              [src]="getTopThree()[2].logoUrl"
              [alt]="getTopThree()[2].teamName + ' logo'"
              class="podium-logo"
            />
          </div>
          <div class="podium-team">{{ getTopThree()[2].teamName }}</div>
          <div class="podium-points">{{ getTopThree()[2].totalPoints }}</div>
        </div>
        <div class="podium-block third"></div>
      </div>
    </div>
  </div>

  <div class="leaderboard-table-container">
    <table class="leaderboard-table">
      <thead>
        <tr>
          <th class="rank-column">#</th>
          <th
            class="team-column"
            style="text-align: start"
            (click)="sortBy('teamName')"
            [class.sorted]="sortKey === 'teamName'"
          >
            Team
            <span *ngIf="sortKey === 'teamName'">{{
              sortAsc ? "‚ñ≤" : "‚ñº"
            }}</span>
          </th>

          <th
            class="points-column total-column"
            (click)="sortBy('totalPoints')"
            [class.sorted]="sortKey === 'totalPoints'"
          >
            PTS
            <span *ngIf="sortKey === 'totalPoints'">{{
              sortAsc ? "‚ñ≤" : "‚ñº"
            }}</span>
          </th>
          <th
            class="points-column"
            (click)="sortBy('bracketPoints')"
            [class.sorted]="sortKey === 'bracketPoints'"
          >
            Bracket
            <span *ngIf="sortKey === 'bracketPoints'">{{
              sortAsc ? "‚ñ≤" : "‚ñº"
            }}</span>
          </th>
          <th
            class="points-column"
            (click)="sortBy('lineupPoints')"
            [class.sorted]="sortKey === 'lineupPoints'"
          >
            Kokoonpano
            <span *ngIf="sortKey === 'lineupPoints'">{{
              sortAsc ? "‚ñ≤" : "‚ñº"
            }}</span>
          </th>
          <th
            class="points-column"
            (click)="sortBy('predictionsPoints')"
            [class.sorted]="sortKey === 'predictionsPoints'"
          >
            Top 3
            <span *ngIf="sortKey === 'predictionsPoints'">{{
              sortAsc ? "‚ñ≤" : "‚ñº"
            }}</span>
          </th>
        </tr>
      </thead>
      <tbody>
        <tr
          *ngFor="let entry of leaderboardEntries"
          [class.current-user]="isCurrentUser(entry.id)"
        >
          <td class="rank-column">
            <span class="rank-number">{{ entry.rank }}</span>
          </td>

          <td class="team-column">
            <img
              *ngIf="entry.logoUrl"
              [src]="entry.logoUrl"
              [alt]="entry.teamName + ' logo'"
              class="team-logo"
            />
            <a [routerLink]="['/user', entry.teamName]" class="team-link">{{
              entry.teamName
            }}</a>
          </td>
          <td class="points-column total-points">{{ entry.totalPoints }}</td>
          <td class="points-column">{{ entry.bracketPoints }}</td>
          <td class="points-column">{{ entry.lineupPoints }}</td>
          <td class="points-column">{{ entry.predictionsPoints }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
